@page "/profile"

@using NS.Shared.Resources.Enum
@using NS.WEB.Modules.Profile.Resources
@using NS.WEB.Modules.Subscription.Core
@inherits PageCore<Profile>

@inject IJSRuntime JsRuntime
@inject PaddleConfigurationApi ConfigurationApi

<SeoHeader Title="@SeoTranslations.ProfileTitle" Description="@SeoTranslations.ProfileDescription" Url="/profile" Index="false" Keywords="@([])"></SeoHeader>

@* <GoogleAdSense Section="@GoogleAdSense.AdUnit.Profile" IsAuthenticated="IsAuthenticated" Format="horizontal"></GoogleAdSense> *@

@if (!IsAuthenticated)
{
    <MudCarousel ShowArrows="true" AutoCycle="true" TData="object" Class="mud-width-full mb-5" Style="@($"height: {(Breakpoint <= Breakpoint.Xs ? 450 : 300)}px;")">
        <MudCarouselItem Transition="Transition.Slide" Color="@Color.Primary" Class="px-10 pt-2 pb-10" Style="text-align: center; height: 100%;">
            <MudGrid Spacing="2" Justify="Justify.Center" Style="@($"{(Breakpoint <= Breakpoint.Xs ? "max-height" : "height")}: 100%; align-content: center;")">
                <MudItem xs="12" sm="6" Style="height: 100%; align-content: center;">
                    <MudImage Src="visitor-slide-1.png" Style="@($"max-width: {(Breakpoint <= Breakpoint.Xs ? "80" : "100")}%;")"></MudImage>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudText Typo="Typo.h5" Align="Align.Center" Class="my-3">
                        @SeoTranslations.AppName
                    </MudText>
                    <MudText Typo="Typo.body1" Align="Align.Justify" Class="my-3">
                        @SeoTranslations.AppDescription
                    </MudText>
                </MudItem>
            </MudGrid>
        </MudCarouselItem>
        <MudCarouselItem Transition="Transition.Slide" Color="@Color.Primary" Class="px-10 pt-2 pb-10" Style="text-align: center; height: 100%;">
            <MudStack Style="@($"{(Breakpoint <= Breakpoint.Xs ? "max-height" : "height")}: 100%;")">
                <MudText Typo="Typo.h5" Align="Align.Center" Class="mt-3">
                    @Resources.Translations.TopFeatures
                </MudText>
                <MudStack Row="true" Style="height: calc(100% - 44px);">
                    <MudGrid Spacing="2" Justify="Justify.Center" Style="height: 100%; align-content: center;">
                        <MudItem xs="6" sm="3" Style="max-height: 100%; align-content: center;">
                            <MudPaper Class="pa-2" Elevation="3" Style="text-align:center; width: 100%; height: 100%;">
                                <MudImage Src="visitor-slide-2-trending.png" Style="@($"max-height: calc(100% - 64px); max-width: {(Breakpoint <= Breakpoint.Sm ? "65" : "100")}%;")"></MudImage>
                                <MudText Typo="Typo.subtitle1" Style="line-height: 1.3">
                                    @Resources.Translations.TopFeaturesTitle1
                                </MudText>
                            </MudPaper>
                        </MudItem>
                        <MudItem xs="6" sm="3" Style="max-height: 100%; align-content: center;">
                            <MudPaper Class="pa-2" Elevation="3" Style="text-align:center; width: 100%; height: 100%;">
                                <MudImage Src="visitor-slide-2-platforms.png" Style="@($"max-height: calc(100% - 64px); max-width: {(Breakpoint <= Breakpoint.Sm ? "65" : "100")}%;")"></MudImage>
                                <MudText Typo="Typo.subtitle1" Style="line-height: 1.3">
                                    @Resources.Translations.TopFeaturesTitle2
                                </MudText>
                            </MudPaper>
                        </MudItem>
                        <MudItem xs="6" sm="3" Style="max-height: 100%; align-content: center;">
                            <MudPaper Class="pa-2" Elevation="3" Style="text-align:center; width: 100%; height: 100%;">
                                <MudImage Src="visitor-slide-2-manage.png" Style="@($"max-height: calc(100% - 64px); max-width: {(Breakpoint <= Breakpoint.Sm ? "65" : "100")}%;")"></MudImage>
                                <MudText Typo="Typo.subtitle1" Style="line-height: 1.3">
                                    @Resources.Translations.TopFeaturesTitle3
                                </MudText>
                            </MudPaper>
                        </MudItem>
                        <MudItem xs="6" sm="3" Style="max-height: 100%; align-content: center;">
                            <MudPaper Class="pa-2" Elevation="3" Style="text-align:center; width: 100%; height: 100%;">
                                <MudImage Src="visitor-slide-2-collections.png" Style="@($"max-height: calc(100% - 64px); max-width: {(Breakpoint <= Breakpoint.Sm ? "65" : "100")}%;")"></MudImage>
                                <MudText Typo="Typo.subtitle1" Style="line-height: 1.3">
                                    @Resources.Translations.TopFeaturesTitle4
                                </MudText>
                            </MudPaper>
                        </MudItem>
                    </MudGrid>
                </MudStack>
            </MudStack>
        </MudCarouselItem>
        <MudCarouselItem Transition="Transition.Slide" Color="@Color.Primary" Class="px-12 pt-2 pb-6" Style="text-align: center; height: 100%;">
            <MudText Typo="Typo.h5" Align="Align.Center" Class="my-3">
                @Translations.HeroCall
            </MudText>
            <MudButton Variant="Variant.Filled" Color="Color.Secondary" OnClick="Login" Class="my-4">
                @Translations.HeroButton
            </MudButton>
            <MudText Typo="Typo.caption" Align="Align.Center" Class="my-3 d-block" Style="bottom: 50px; position: absolute; left: 0; right: 0;">
                @Translations.HeroNote
            </MudText>
        </MudCarouselItem>
    </MudCarousel>
}

<MudGrid Spacing="2" Class="mb-2">
    <MudItem xs="6" md="3">
        <MudPaper Outlined="true" Class="pa-1">
           @*  <div class="d-flex" style="align-self: center;">
                <MudIcon Icon="@IconsFA.Solid.Icon("clapperboard").Font" Color="Color.Primary" Class="me-2"></MudIcon>
                <MudText Typo="Typo.subtitle1" Color="Color.Primary">
                    @Translations.Platforms
                </MudText>
            </div>
            <MudChip T="string" Color="Color.Secondary" Label="true" Style="padding: 0.2rem; height: auto;"Size="AppStateStatic.Size">
                @(MyProviders?.Items.Count ?? 0)
            </MudChip> *@
        </MudPaper>
    </MudItem>
    <MudItem xs="6" md="3">
        <MudPaper Outlined="true" Class="pa-1">
            @* <div class="d-flex" style="align-self: center;">
                <MudIcon Icon="@IconsFA.Solid.Icon("bookmark").Font" Color="Color.Primary" Class="me-2"></MudIcon>
                <MudText Typo="Typo.subtitle1" Color="Color.Primary">
                    @Translations.Wishlist
                </MudText>
            </div>
            <MudChip T="string" Color="Color.Secondary" Label="true" Style="padding: 0.2rem; height: auto;"Size="AppStateStatic.Size">
                @(Wish?.Movies.Count ?? 0) @PopularType.MovieName
            </MudChip>
            <MudChip T="string" Color="Color.Secondary" Label="true" Style="padding: 0.2rem; height: auto;"Size="AppStateStatic.Size">
                @(Wish?.Shows.Count ?? 0) @PopularType.ShowName
            </MudChip> *@
        </MudPaper>
    </MudItem>
    <MudItem xs="6" md="3">
        <MudPaper Outlined="true" Class="pa-1">
            @* <div class="d-flex" style="align-self: center;">
                <MudIcon Icon="@IconsFA.Solid.Icon("eye").Font" Color="Color.Primary" Class="me-2"></MudIcon>
                <MudText Typo="Typo.subtitle1" Color="Color.Primary">
                    @Translations.Watching
                </MudText>
            </div>
            <MudChip T="string" Color="Color.Secondary" Label="true" Style="padding: 0.2rem; height: auto;"Size="AppStateStatic.Size">
                @(Watching?.Movies.Count ?? 0) @PopularType.MovieName
            </MudChip>
            <MudChip T="string" Color="Color.Secondary" Label="true" Style="padding: 0.2rem; height: auto;"Size="AppStateStatic.Size">
                @(Watching?.Shows.Count ?? 0) @PopularType.ShowName
            </MudChip> *@
        </MudPaper>
    </MudItem>
    <MudItem xs="6" md="3">
        <MudPaper Outlined="true" Class="pa-1">
           @*  <div class="d-flex" style="align-self: center;">
                <MudIcon Icon="@IconsFA.Solid.Icon("clock-rotate-left").Font" Color="Color.Primary" Class="me-2"></MudIcon>
                <MudText Typo="Typo.subtitle1" Color="Color.Primary">
                    @Translations.Watched
                </MudText>
            </div>
            <MudChip T="string" Color="Color.Secondary" Label="true" Style="padding: 0.2rem; height: auto;"Size="AppStateStatic.Size">
                @(Watched?.Movies.Count ?? 0) @PopularType.MovieName
            </MudChip>
            <MudChip T="string" Color="Color.Secondary" Label="true" Style="padding: 0.2rem; height: auto;"Size="AppStateStatic.Size">
                @(Watched?.Shows.Count ?? 0) @PopularType.ShowName
            </MudChip> *@
        </MudPaper>
    </MudItem>
</MudGrid>

@code {
    public string? Reviewed { get; set; }

    protected override async Task LoadNonEssentialDataAsync()
    {
        Reviewed = await JsRuntime.InvokeAsync<string>("GetLocalStorage", "reviewed");
    }

    private void Login()
    {
        Navigation.NavigateTo("/.auth/login/aad?post_login_redirect_uri=" + Navigation.BaseUri + "login-success", true);
    }

    // private async Task SetReviewed()
    // {
    //     await JsRuntime.InvokeAsync<string>("SetLocalStorage", "reviewed", "true");
    //     Reviewed = "true";
    // }
}
